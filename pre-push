#!/bin/sh
# pre-push hook for Go projects

# Exit immediately if a command exits with a non-zero status
set -e

echo "Running go vet..."
go vet ./...

echo "Running tests..."
go test ./... -v

echo "Checking for race conditions..."
go test -race ./...

echo "Building the project..."
go build ./...

echo "Running golangci-lint..."
golangci-lint run

echo "Verifying go.mod and go.sum..."
go mod tidy
git diff --exit-code go.mod go.sum

echo "Checking for large files..."
LARGE_FILES=$(find . -type f -size +5M)
if [ -n "$LARGE_FILES" ]; then
    echo "Error: The following large files were found:"
    echo "$LARGE_FILES"
    exit 1
fi

echo "All pre-push checks passed successfully."
exit 0
